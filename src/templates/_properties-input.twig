{# @param propertiesFieldConfig array The list of configured properties #}
{# @param properties array the property values as stored in the database #}
{# @param element Element The currently edited element #}
{# @param field Field The field type #}
{# @param settings Settings The plugin settings #}


{% import '_includes/forms.twig' as forms %}

{% set color = field.color %}
{% if not color or color == '__blank__' %}
    {% set color = 'gray' %}
{% endif %}


{% namespace field.handle %}
    <table class="editable fullwidth">

        {% if settings.showTableHeader %}
            <thead>
            <tr>
                <th scope="col" class="singleline-cell textual">{{ 'Property'|t }}</th>
                <th scope="col" class="multiline-cell textual">{{ 'Value'|t }}</th>
            </tr>
            </thead>
        {% endif %}

        <tbody>
        {% for propertyConfig in propertiesFieldConfig %}
            {% if propertyConfig.type == 'groupHeader' %}
                <tr>
                    <th colspan="2" class="group-header">
                        {{ propertyConfig.name }}
                    </th>
                </tr>
            {% else %}
                <tr>
                    <th class="heading-cell thin"
                        style="background-color: var(--{{ color }}-050); text-align: left; padding: 7px;">
                        {{ propertyConfig.name|t }}
                        {% if propertyConfig.instructions ?? null %}
                            <span class="info">
                            {{ propertyConfig.instructions|t }}
                        </span>
                        {% endif %}
                        {% if propertyConfig.required ?? false %}
                            <span class="required"></span>
                        {% endif %}
                    </th>

                    <td class="singleline-cell textual">

                        {% set template = settings.extraPropertiesConfig[propertyConfig.type].template ?? settings.propertiesConfig[propertyConfig.type].template %}

                        {{ craft.app.view.renderTemplate(template, {
                            propertyConfig,
                            value: properties[propertyConfig.handle] ?? null,
                            settings
                        }, 'cp')|raw }}

                    </td>
                </tr>
            {% endif %}
        {% endfor %}
        </tbody>
    </table>

    {% if field.tip %}
        <div id="tip" class="notice has-icon"><span class="icon" aria-hidden="true"></span><span
                    class="visually-hidden">Tip: </span><span>{{ field.tip|md|purify }}</span></div>
    {% endif %}

    {% if field.warning %}
        <div id="warning" class="warning has-icon"><span class="icon" aria-hidden="true"></span><span
                    class="visually-hidden">Warning: </span><span>{{ field.warning|md|purify }}</span>
        </div>
    {% endif %}

{% endnamespace %}

{% css %}
.text-combined {
    border: 1px solid gray !important;
}

.text-margin {
    margin-left: 8px;
}

.group-header {
    font-weight: 700 !important;

    background-color: var(--{{ color }}-100) !important;
    text-transform: uppercase;
    letter-spacing: 1px;
    padding: 8px 0;
}
{% endcss %}